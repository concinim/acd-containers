{"version":3,"file":"component---src-pages-security-manage-access-md-4e01ff76647c3b547152.js","mappings":"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","sources":["webpack://acd-containers/./node_modules/gatsby-theme-carbon/src/components/PageHeader/index.js","webpack://acd-containers/./node_modules/gatsby-theme-carbon/src/components/PageHeader/PageHeader.js","webpack://acd-containers/./node_modules/gatsby-theme-carbon/src/components/PageHeader/PageHeader.module.scss","webpack://acd-containers/./node_modules/gatsby-theme-carbon/src/components/EditLink/index.js","webpack://acd-containers/./node_modules/gatsby-theme-carbon/src/components/EditLink/EditLink.js","webpack://acd-containers/./node_modules/gatsby-theme-carbon/src/components/EditLink/EditLink.module.scss","webpack://acd-containers/./node_modules/gatsby-theme-carbon/src/components/PageTabs/PageTabs.js","webpack://acd-containers/./node_modules/gatsby-theme-carbon/src/components/PageTabs/PageTabs.module.scss","webpack://acd-containers/./node_modules/gatsby-theme-carbon/src/components/PageTabs/index.js","webpack://acd-containers/./node_modules/gatsby-theme-carbon/src/components/LastModifiedDate/index.js","webpack://acd-containers/./node_modules/gatsby-theme-carbon/src/components/LastModifiedDate/LastModifiedDate.js","webpack://acd-containers/./node_modules/gatsby-theme-carbon/src/components/LastModifiedDate/last-modified-date.module.scss","webpack://acd-containers/./node_modules/gatsby-theme-carbon/src/templates/Default.js","webpack://acd-containers/./src/pages/security/manage-access.md"],"sourcesContent":["import PageHeader from './PageHeader';\n\nexport default PageHeader;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\nimport * as styles from './PageHeader.module.scss';\n\nconst PageHeader = ({ title, theme, tabs = [] }) => (\n  <div\n    className={cx(styles.pageHeader, {\n      [styles.withTabs]: tabs.length,\n      [styles.darkMode]: theme === 'dark',\n    })}>\n    <div className=\"bx--grid\">\n      <div className=\"bx--row\">\n        <div className=\"bx--col-lg-12\">\n          <h1 id=\"page-title\" className={styles.text}>\n            {title}\n          </h1>\n        </div>\n      </div>\n    </div>\n  </div>\n);\n\nPageHeader.propTypes = {\n  /**\n   * Specify the title for the page\n   */\n  title: PropTypes.node,\n};\n\nexport default PageHeader;\n","// extracted by mini-css-extract-plugin\nexport var bxTextTruncateEnd = \"PageHeader-module--bx--text-truncate--end--b8JtW\";\nexport var bxTextTruncateFront = \"PageHeader-module--bx--text-truncate--front--WwZFh\";\nexport var darkMode = \"PageHeader-module--dark-mode--WCeH8\";\nexport var pageHeader = \"PageHeader-module--page-header--NqfPe\";\nexport var text = \"PageHeader-module--text--Er2EO\";\nexport var withTabs = \"PageHeader-module--with-tabs--vbQ-W\";","import EditLink from './EditLink';\n\nexport default EditLink;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { graphql, useStaticQuery } from 'gatsby';\n\nimport { link, row } from './EditLink.module.scss';\n\nconst EditLink = ({ relativePagePath, repository: repositoryProp }) => {\n  const {\n    site: {\n      siteMetadata: { repository },\n    },\n  } = useStaticQuery(graphql`\n    query REPOSITORY_QUERY {\n      site {\n        siteMetadata {\n          repository {\n            baseUrl\n            subDirectory\n            branch\n          }\n        }\n      }\n    }\n  `);\n\n  const { baseUrl, subDirectory, branch } = repositoryProp || repository;\n\n  const href = `${baseUrl}/edit/${branch}${subDirectory}/src/pages${relativePagePath}`;\n\n  return baseUrl ? (\n    <div className={`bx--row ${row}`}>\n      <div className=\"bx--col\">\n        <a className={link} href={href}>\n          Edit this page on GitHub\n        </a>\n      </div>\n    </div>\n  ) : null;\n};\n\nEditLink.propTypes = {\n  repository: PropTypes.shape({\n    baseUrl: PropTypes.string,\n    subDirectory: PropTypes.string,\n    branch: PropTypes.string,\n  }),\n  relativePagePath: PropTypes.string,\n};\n\nexport default EditLink;\n","// extracted by mini-css-extract-plugin\nexport var bxTextTruncateEnd = \"EditLink-module--bx--text-truncate--end--uI0cF\";\nexport var bxTextTruncateFront = \"EditLink-module--bx--text-truncate--front--HxjcS\";\nexport var link = \"EditLink-module--link--IDrl1\";\nexport var row = \"EditLink-module--row--BEmSX\";","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from 'gatsby';\nimport slugify from 'slugify';\nimport cx from 'classnames';\n\nimport {\n  tabsContainer,\n  list,\n  selectedItem,\n  listItem,\n  link,\n} from './PageTabs.module.scss';\n\nexport default class PageTabs extends React.Component {\n  render() {\n    const { title, tabs, slug } = this.props;\n    const currentTab = slug.split('/').filter(Boolean).slice(-1)[0];\n\n    const pageTabs = tabs.map((tab) => {\n      const slugifiedTab = slugify(tab, { lower: true, strict: true });\n      const selected = slugifiedTab === currentTab;\n      // matches with or without trailing slash: /?\n      // matches with or without hash link: (#.*)?\n      const currentTabRegex = new RegExp(`${currentTab}/?(#.*)?$`);\n      const href = slug.replace(currentTabRegex, slugifiedTab);\n      return (\n        <li key={tab} className={cx({ [selectedItem]: selected }, listItem)}>\n          <Link className={link} to={`${href}`}>\n            {tab}\n          </Link>\n        </li>\n      );\n    });\n\n    return (\n      <div className={tabsContainer}>\n        <div className=\"bx--grid\">\n          <div className=\"bx--row\">\n            <div className=\"bx--col-lg-12 bx--col-no-gutter\">\n              <nav aria-label={title}>\n                <ul className={list}>{pageTabs}</ul>\n              </nav>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nPageTabs.propTypes = {\n  tabs: PropTypes.array,\n  slug: PropTypes.string,\n};\n","// extracted by mini-css-extract-plugin\nexport var bxTextTruncateEnd = \"PageTabs-module--bx--text-truncate--end--OC59x\";\nexport var bxTextTruncateFront = \"PageTabs-module--bx--text-truncate--front--5I6-L\";\nexport var link = \"PageTabs-module--link--Kz-7R\";\nexport var list = \"PageTabs-module--list--xLqxG\";\nexport var listItem = \"PageTabs-module--list-item--024o6\";\nexport var selectedItem = \"PageTabs-module--selected-item--aBB0K\";\nexport var tabsContainer = \"PageTabs-module--tabs-container--Cdfzw\";","import PageTabs from './PageTabs';\n\nexport default PageTabs;\n","import LastModifiedDate from './LastModifiedDate';\n\nexport default LastModifiedDate;\n","import React from 'react';\nimport { Row, Column } from '../Grid';\nimport * as styles from './last-modified-date.module.scss';\n\nconst LastModifiedDate = ({ date }) => {\n  const options = {\n    day: '2-digit',\n    year: 'numeric',\n    month: 'long',\n  };\n\n  const lastModified = new Date(date);\n\n  return date ? (\n    <Row className={styles.row}>\n      <Column>\n        <div className={styles.text}>\n          Page last updated: {lastModified.toLocaleDateString('en-GB', options)}\n          {/* // https://www-03preprod.ibm.com/support/knowledgecenter/ibm_style/dates-and-times.html */}\n        </div>\n      </Column>\n    </Row>\n  ) : null;\n};\nexport default LastModifiedDate;\n","// extracted by mini-css-extract-plugin\nexport var bxTextTruncateEnd = \"last-modified-date-module--bx--text-truncate--end--QgCc7\";\nexport var bxTextTruncateFront = \"last-modified-date-module--bx--text-truncate--front--kel8a\";\nexport var row = \"last-modified-date-module--row--XJoYQ\";\nexport var text = \"last-modified-date-module--text--ogPQF\";","import React from 'react';\nimport slugify from 'slugify';\nimport { useStaticQuery, graphql } from 'gatsby';\n\nimport Utils from '../components/Utils';\nimport Layout from '../components/Layout';\nimport PageHeader from '../components/PageHeader';\nimport EditLink from '../components/EditLink';\nimport NextPrevious from '../components/NextPrevious';\nimport PageTabs from '../components/PageTabs';\nimport Main from '../components/Main';\nimport useMetadata from '../util/hooks/useMetadata';\nimport LastModifiedDate from '../components/LastModifiedDate';\n\nconst Default = ({ pageContext, children, location, Title }) => {\n  const { frontmatter = {}, relativePagePath, titleType } = pageContext;\n  const {\n    tabs,\n    title,\n    theme: frontmatterTheme,\n    description,\n    keywords,\n    date,\n  } = frontmatter;\n\n  const { interiorTheme } = useMetadata();\n\n  // get the path prefix if it exists\n  const {\n    site: { pathPrefix },\n  } = useStaticQuery(graphql`\n    query PATH_PREFIX_QUERY {\n      site {\n        pathPrefix\n      }\n    }\n  `);\n\n  // let gatsby handle prefixing\n  const slug = pathPrefix\n    ? location.pathname.replace(pathPrefix, '')\n    : location.pathname;\n\n  const getCurrentTab = () => {\n    if (!tabs) return '';\n    return (\n      slug.split('/').filter(Boolean).slice(-1)[0] ||\n      slugify(tabs[0], { lower: true })\n    );\n  };\n\n  const currentTab = getCurrentTab();\n\n  const theme = frontmatterTheme || interiorTheme;\n\n  return (\n    <Layout\n      tabs={tabs}\n      homepage={false}\n      theme={theme}\n      pageTitle={title}\n      pageDescription={description}\n      pageKeywords={keywords}\n      titleType={titleType}>\n      <PageHeader\n        title={Title ? <Title /> : title}\n        label=\"label\"\n        tabs={tabs}\n        theme={theme}\n      />\n      {tabs && (\n        <PageTabs\n          title={title}\n          slug={slug}\n          tabs={tabs}\n          currentTab={currentTab}\n        />\n      )}\n      <Main padded>\n        {children}\n        <EditLink relativePagePath={relativePagePath} />\n        <LastModifiedDate date={date} />\n      </Main>\n      <NextPrevious\n        pageContext={pageContext}\n        location={location}\n        slug={slug}\n        tabs={tabs}\n        currentTab={currentTab}\n      />\n      <Utils />\n    </Layout>\n  );\n};\n\nexport default Default;\n","import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/runner/work/acd-containers/acd-containers/node_modules/gatsby-theme-carbon/src/templates/Default.js\";\nexport const _frontmatter = {};\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h2>{`Managing access to ACD`}</h2>\n    <p>{`If you have applications that run outside of the cluster and want to provide secure access to the ACD service in the cluster, you can use the OpenShift-provided OAuth service with a `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/openshift/oauth-proxy\"\n      }}>{`proxy`}</a>{` and a service account to do role-based access control (RBAC) access to the service.\nIn the example below, we’ll use a 4.8 version of the OpenShift OAuth proxy.  See `}<a parentName=\"p\" {...{\n        \"href\": \"https://catalog.redhat.com/software/containers/openshift4/ose-oauth-proxy/5cdb2133bed8bd5717d5ae64?container-tabs=gti\"\n      }}>{`instructions here`}</a>{` for how to pull this image.  You can update the version to match your OpenShift version.  We set the replica count to 2 which gives some level of high-availability (HA) and distributes the workload some.  You may need to increase the replica count based on load.`}</p>\n    <ol>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Create a project/namespace for the proxy to run in (the examples below use `}<inlineCode parentName=\"p\">{`acd-oauth-proxy`}</inlineCode>{`)`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`proxy_namespace=acd-oauth-proxy\noc create namespace \\${proxy_namespace}\n`}</code></pre>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Download the yaml below and save it as “acd-oauth-proxy.yaml”.  Edit it with these changes:`}</p>\n        <ul parentName=\"li\">\n          <li parentName=\"ul\">{`In the args section, on this line `}<inlineCode parentName=\"li\">{`--upstream=https://merative-acd-acd.<acd_namespace>.svc`}</inlineCode>{` change <acd_namespace`}{`>`}{` to the namespace your ACD instance is running in (the target service).`}</li>\n          <li parentName=\"ul\">{`On this line `}<inlineCode parentName=\"li\">{`--openshift-delegate-urls={\"/\":{\"resource\":\"services\",\"verb\":\"get\",\"namespace\":<acd_namespace>}}`}</inlineCode>{`change <acd_namespace`}{`>`}{` again to match your target ACD namespace.`}</li>\n        </ul>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-yaml\",\n            \"metastring\": \"acd-oauth-proxy.yaml\",\n            \"acd-oauth-proxy.yaml\": true\n          }}>{` kind: List\n apiVersion: v1\n items:\n # Create a proxy service account and ensure it will use the route \"proxy\"\n - apiVersion: v1\n   kind: ServiceAccount\n   metadata:\n     name: proxy\n     annotations:\n       serviceaccounts.openshift.io/oauth-redirectreference.primary: '{\"kind\":\"OAuthRedirectReference\",\"apiVersion\":\"v1\",\"reference\":{\"kind\":\"Route\",\"name\":\"proxy\"}}'\n # Create a secure connection to the proxy via a route\n - apiVersion: route.openshift.io/v1\n   kind: Route\n   metadata:\n     name: proxy\n   spec:\n     to:\n       kind: Service\n       name: proxy\n     tls:\n       termination: Reencrypt\n - apiVersion: v1\n   kind: Service\n   metadata:\n     name: proxy\n     annotations:\n       service.alpha.openshift.io/serving-cert-secret-name: proxy-tls\n   spec:\n     ports:\n     - name: proxy\n       port: 443\n       targetPort: 8443\n     selector:\n       app: proxy\n # Launch a proxy as a deployment\n # use           - --set-xauthrequest=true option to send back the user info in the response to nginx or client\n # see https://catalog.redhat.com/software/containers/openshift4/ose-oauth-proxy/5cdb2133bed8bd5717d5ae64?container-tabs=gti\n - apiVersion: apps/v1\n   kind: Deployment\n   metadata:\n     name: proxy\n   spec:\n     replicas: 2\n     selector:\n       matchLabels:\n         app: proxy\n     template:\n       metadata:\n         labels:\n           app: proxy\n       spec:\n         serviceAccountName: proxy\n         containers:\n         - name: oauth-proxy\n           image: registry.redhat.io/openshift4/ose-oauth-proxy:v4.8\n           imagePullPolicy: IfNotPresent\n           ports:\n           - containerPort: 8443\n             name: public\n           args:\n           - --https-address=:8443\n           - --provider=openshift\n           - --request-logging=true\n           - --openshift-service-account=proxy\n           - --upstream=https://merative-acd-acd.<acd_namespace>.svc\n           - --openshift-delegate-urls={\"/\":{\"resource\":\"services\",\"verb\":\"get\",\"namespace\":\"<acd_namespace>\"}}\n           - --ssl-insecure-skip-verify=false\n           - --upstream-ca=/var/run/secrets/kubernetes.io/serviceaccount/service-ca.crt\n           - --tls-cert=/etc/tls/private/tls.crt\n           - --tls-key=/etc/tls/private/tls.key\n           - --cookie-secret=SECRET\n           - --footer=-\n           volumeMounts:\n           - mountPath: /etc/tls/private\n             name: proxy-tls\n         volumes:\n         - name: proxy-tls\n           secret:\n             secretName: proxy-tls\n`}</code></pre>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Change to your project/namespace used in Step 1:`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-yaml\"\n          }}>{`oc project \\${proxy_namespace}\n`}</code></pre>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Set a variable for your ACD namespace. Replace <acd_namespace> with your target ACD namespace name.`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-yaml\"\n          }}>{`acd_namespace=<acd_namespace>\n`}</code></pre>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Next apply the yaml file.  This should create a deployment for the proxy, a service to that deployment, a route to that service, and a proxy service account in your new project that was created in Step 1:`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-yaml\"\n          }}>{`oc create -f acd-oauth-proxy.yaml\n`}</code></pre>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Because we are using the `}<inlineCode parentName=\"p\">{`--openshift-delegate-urls`}</inlineCode>{` option of the proxy, we need to configure the service account that checks the token permission to create a TokenReview at the cluster level.  We’ll do this by binding the proxy service account to the predefined `}<inlineCode parentName=\"p\">{`system:auth-delegator`}</inlineCode>{` cluster role:`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-yaml\"\n          }}>{`oc adm policy add-cluster-role-to-user system:auth-delegator -z proxy -n \\${proxy_namespace}\n`}</code></pre>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`The `}<inlineCode parentName=\"p\">{`--openshift-delegate-urls`}</inlineCode>{` parameter above says it will check if the user/token coming in has the ability to do a `}<inlineCode parentName=\"p\">{`get`}</inlineCode>{` operation on the services in the target namespace, and will check to ensure the service account has access to the target ACD instance.  We need to create a namespace-scoped role on the target ACD project and grant access to the service account that will be used to call ACD.  To start, create a role (named `}<inlineCode parentName=\"p\">{`serviceview`}</inlineCode>{`) on the namespace where ACD is running:`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-yaml\"\n          }}>{`oc create role serviceview --verb=get --resource=service -n \\${acd_namespace}\n`}</code></pre>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Now bind that role to the service account created above:`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-yaml\"\n          }}>{`oc adm policy add-role-to-user serviceview system:serviceaccount:\\${proxy_namespace}:proxy --role-namespace=\\${acd_namespace} -n \\${acd_namespace}\n`}</code></pre>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Create a token to use on the service account:`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-yaml\"\n          }}>{`oc serviceaccounts new-token proxy -n \\${proxy_namespace}\n`}</code></pre>\n        <p parentName=\"li\">{`Copy the token returned.`}</p>\n        <p parentName=\"li\"><strong parentName=\"p\">{`Note`}</strong>{`: This token is also stored in a secret named “proxy-token-nnnnn” in the target project, and when you delete that it will remove the token from the account after a bit. You can add additional tokens and remove the secret to rotate your tokens for your app.`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Use the token you just created as a bearer token to call ACD through the proxy route passing the bearer token on the Authorization header.  For example:`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-yaml\"\n          }}>{`curl -X GET -H \"Authorization: Bearer eyJ....z9g\" -k \"https://<proxy_route_name>-<proxy_route_namespace>.apps.yourserver.com/services/clinical_data_annotator/api/v1/flows?version=2021-05-18\"\n`}</code></pre>\n      </li>\n    </ol>\n    <p>{`The `}<inlineCode parentName=\"p\">{`openshift-delegate-urls`}</inlineCode>{` parameter says which paths it should forward and what the caller needs to have access to in order to allow it.  In the preceding example, we forward all calls (’/’) if the caller has `}<inlineCode parentName=\"p\">{`get`}</inlineCode>{` access to the services in the target ACD namespace (for which we created the role and granted permission to the service account).  For more informnation on OpenShift RBAC access refer to `}<a parentName=\"p\" {...{\n        \"href\": \"https://docs.openshift.com/container-platform/4.7/authentication/using-rbac.html\"\n      }}>{`https://docs.openshift.com/container-platform/4.7/authentication/using-rbac.html`}</a></p>\n    <p>{`Note that we have the proxy service account doing double-duty.  It is used to run the proxy service and do the TokenReview (so it needed the cluster role binding).  We also have it as the service account that is calling into ACD and we bound it to the `}<inlineCode parentName=\"p\">{`serviceview`}</inlineCode>{` role to allow it.  In practice, you have many service accounts and their tokens are used to act as different ACD tenants.`}</p>\n    <p>{`Also note that if your application runs in the cluster, you may want to consider using `}<a parentName=\"p\" {...{\n        \"href\": \"https://docs.openshift.com/container-platform/4.7/authentication/bound-service-account-tokens.html\"\n      }}>{`bound service access tokens`}</a>{` to have the tokens dynamically generated and rotated by the kubelet using the `}<a parentName=\"p\" {...{\n        \"href\": \"https://jpweber.io/blog/a-look-at-tokenrequest-api/\"\n      }}>{`TokenRequest API`}</a>{`.`}</p>\n    <p>{`More options and details for the proxy are available at `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/openshift/oauth-proxy#openshift-oauth-proxy\"\n      }}>{`OpenShift OAuth Proxy`}</a>{`.`}</p>\n    <p>{`Information on troubleshooting the OAuth Proxy is found at `}<a parentName=\"p\" {...{\n        \"href\": \"/acd-containers/troubleshooting/troubleshooting-the-oauth-proxy/\"\n      }}>{`Troubleshooting the OAuth Proxy`}</a>{`.`}</p>\n    <h3>{`Multitenancy with ACD`}</h3>\n    <p>{`ACD is stateless as far as the text it analyzes and annotations it returns, however, it does store configuration data through cartridges, flows, profiles and associated configuration artifacts.  You can use a single ACD instance with multiple tenants which will provide each tenant its own configuration storage area.  `}</p>\n    <p>{`In order to use multitenancy, you must use a security proxy as described above and use a different service account for each tenant. That provides security and passes back the tenant through a header to ACD, but ACD needs to be configured to honor that header (otherwise, it will use a defaultTenant as a tenant value for all calls).  In the ACD deployment (operand), when you create the instance, you can set the `}<inlineCode parentName=\"p\">{`tenantHeader`}</inlineCode>{` value in the custom resource definition to specify the header to use as the tenant.  With the OAuth proxy above, use the value of `}<inlineCode parentName=\"p\">{`X-Forwarded-User`}</inlineCode>{` (which the proxy sets to the service account name).  In the ACD custom resource definition, this is `}<inlineCode parentName=\"p\">{`tenantHeader: X-Forwarded-User`}</inlineCode>{`.  You can edit or you can patch your instance to change or set it at create time.`}</p>\n    <h3>{`Network policies with ACD`}</h3>\n    <p>{`A set of network policies are created in the target ACD namespace during the installation process. These network policies will only allow network traffic to flow from the ACD macro service to its back-end micro services within the same namespace.  The ACD macro service will also accept incoming connections from any namespace to port 9443 (via the ACD service object) such as a route ingress pod, proxy pod, or other cluster application pod.`}</p>\n    <p>{`You can disable the network policy creation from the web console by setting `}<inlineCode parentName=\"p\">{`Network policy enabled`}</inlineCode>{` to false.  When installing from the command line, set the `}<inlineCode parentName=\"p\">{`networkPolicy.enabled`}</inlineCode>{` property to false.  This will remove any networking restrictions in the ACD namespace.`}</p>\n    <p>{`You can further enhance security by only allowing the ACD macro service to accept network traffic from a specific source namespace and/or its pods.  This can be done during instance creation in the web console by using the YAML View and adding network policy ingress selectors definitions at `}<inlineCode parentName=\"p\">{`spec.networkPolicy.ingress.fromSelectors`}</inlineCode>{`.  From the command line, set `}<inlineCode parentName=\"p\">{`networkPolicy.ingress.fromSelectors`}</inlineCode>{`.`}</p>\n    <p><strong parentName=\"p\">{`Note:`}</strong>{` Creating NetworkPolicy definitions is an advanced topic and requires a good understanding of network policies configurations. More information can be found at `}<a parentName=\"p\" {...{\n        \"href\": \"https://kubernetes.io/docs/concepts/services-networking/network-policies/\"\n      }}>{`Kubernetes Network Policy Documentation`}</a></p>\n    <p>{`Steps:`}</p>\n    <ol>\n      <li parentName=\"ol\">{`Use an existing Kubernetes label or add one to the source’s namespace or deployment descriptor.  This label is used in the NetworkPolicy to determine which incoming network traffic is allowed into the macro service.`}</li>\n      <li parentName=\"ol\">{`Modify the ACD instance yaml configuration (CSV) from the web console by adding a yaml block to the `}<inlineCode parentName=\"li\">{`fromSelectors`}</inlineCode>{` object.  There are two types of selectors, `}<inlineCode parentName=\"li\">{`namespaceSelector`}</inlineCode>{` and `}<inlineCode parentName=\"li\">{`podSelector`}</inlineCode>{`.  Choose one or both depending on the scope of restriction you want.  These selectors will get added to the “networkpolicy-acd-macroservice.yaml” `}<inlineCode parentName=\"li\">{`networkPolicy`}</inlineCode>{` definition in the ACD namespace.`}</li>\n    </ol>\n    <p>{`Example:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`spec:\n  networkPolicy:\n    enabled: true\n    ingress:\n      fromSelectors:\n      - namespaceSelector:\n          matchLabels:\n            <label name>: <label value>\n        podSelector:\n          matchLabels:\n            <label name>: <label value>\n\n# Note that the use of the hyphen (-) on the selectors determines if this restriction is an AND or OR rule.  In the above example, both the 'namespaceSelector' and 'podSelector' have to match since they are in the same array.\n`}</code></pre>\n    <h4>{`Egress`}</h4>\n    <p>{`There are no egress network policies defined for the ACD namespace by default.  All pods within the ACD namespace can send data outside of the namespace including to the internet unless you have other restrictions in place.  It is also possible to restrict egress traffic from within the ACD namespace using network policy egress rules.`}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"names":["title","theme","tabs","className","cx","length","id","relativePagePath","repositoryProp","repository","useStaticQuery","site","siteMetadata","baseUrl","subDirectory","href","branch","PageTabs","render","this","props","slug","currentTab","split","filter","Boolean","slice","pageTabs","map","tab","slugifiedTab","slugify","lower","strict","selected","currentTabRegex","RegExp","replace","key","Link","to","React","date","lastModified","Date","toLocaleDateString","day","year","month","pageContext","children","location","Title","frontmatter","titleType","frontmatterTheme","description","keywords","interiorTheme","useMetadata","pathPrefix","pathname","Layout","homepage","pageTitle","pageDescription","pageKeywords","label","Main","padded","NextPrevious","Utils","_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","mdxType","parentName","isMDXComponent"],"sourceRoot":""}